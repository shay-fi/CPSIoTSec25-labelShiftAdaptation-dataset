# Traffic data for our CPSIoTSec'25 paper

The data contains flow metadata for 638,136 TCP/443 flows collected across 12 smart home subscribers. It is organized into 12 folders, each corresponding to one subscriber. Data for the "representative home" primarily discussed in the paper is located under ``./home04''. 

Each folder contains the full training data, ``train.csv`` (collected between October 20, 2020, and November 20, 2020), and the full test data, ``test_full.csv`` (collected between November 21, 2020, and December 6, 2020). In addition, each home's folder contains 8 CSV files, each representing a sliding window derived from the full test dataset. Each window spans 7 days of test data, with the first window starting on the initial day of the test period. Subsequent windows are generated by shifting the start date forward by one day.

Each test window CSV file contains 23 columns -- 22 for flow-level traffic features and one class label column. The full test and the train CSV files include one additional column: the flow end timestamp. The flow-level features are YAF-exported [IPFIX Information Elements](https://tools.netsa.cert.org/yaf/docs.html#yaf-3-rec-tmpl). Below, we briefly explain these features.  

There are 11 forward features, measured on packets sent from the flow initiator to the other end:
- **packetTotalCount**: Number of packets,
- **octetTotalCount**: Number of Bytes,
- **smallPacketCount**: Number of packets with less than 60 Bytes of payload,
- **largePacketCount**: Number of packets with at least 220 Bytes of payload,
- **nonEmptyPacketCount**: Number of packets with non-empty payload,
- **firstNonEmptyPacketSize**: Number of Bytes in the payload of the first non-empty packet,
- **dataByteCount**: Number of payload Bytes transmitted,
- **averageInterarrivalTime**: The average of the packet interarrival times (milliseconds),
- **maxPacketSize**: The largest payload size in Bytes,
- **standardDeviationPayloadLength**: The standard deviation of payload size (Bytes) for up to the first 10 non-empty packets,
- **standardDeviationInterarrivalTime**: The standard deviation of interarrival times (milliseconds) for up to the first 10 packets,

And 11 reverse features, measured on packets sent from the responder back to the initiator:
- **reversePacketTotalCount**,
- **reverseOctetTotalCount**,
- **reverseSmallPacketCount**,
- **reverseLargePacketCount**,
- **reverseNonEmptyPacketCount**,
- **reverseFirstNonEmptyPacketSize**,
- **reverseDataByteCount**,
- **reverseAverageInterarrivalTime**,
- **reverseMaxPacketSize**,
- **reverseStandardDeviationPayloadLength**,
- **reverseStandardDeviationInterarrivalTime**.


## Cite our data:
<pre>
@INPROCEEDINGS{25CPSIoTSec,
    author = {Azizi, Shayan and Calderan, Felipe Vaiano and Okui, Norihiro and Nakahara, Masataka and Kubota, Ayumu and Quiles, Marcos G. and Batista, Gustavo and Habibi Gharakheili, Hassan},
    booktitle = {Proc. CPSIoTSec},
    title = {{Towards Label Shift Adaptation for Robust IoT Device Identification}},
    year = {2025},
    month = {Oct},
    address = {Taipei, Taiwan},
    doi = {10.1145/3733801.3764204}
}


## Related Links:
https://iotanalytics.unsw.edu.au